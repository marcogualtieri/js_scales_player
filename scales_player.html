<html class="no-js" lang="">
    
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>JS Scales Player</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style type="text/css">
            body {
                background-color: #484d6d;
            }
        </style>
    </head>
    
    <body>

        <select id="tonality">
            <option value="0">DO / C</option>
            <option value="1">DO# / C#</option>
            <option value="2">RE / D</option>
            <option value="3">RE / D</option>
            <option value="4">MI / E</option>
            <option value="5">FA / F</option>
            <option value="6">FA# / F#</option>
            <option value="7">SOL / G</option>
            <option value="8">SOL# / G#</option>
            <option value="9">LA / A</option>
            <option value="10">LA# / A</option>
            <option value="11">SI / B</option>
        </select>

        <select id="scale">
            <option value="ionian">Ionian (I)</option>
            <option value="dorian">Dorian (II)</option>
            <option value="phrygian">Phrygian (III)</option>
            <option value="lydian">Lydian (IV)</option>
            <option value="mixolydian">Mixolydian (V)</option>
            <option value="aeolian">Aeolian (VI)</option>
            <option value="locrian">Locrian (VII)</option>
        </select>

        <button type="button" onclick="playScale();return false;">Play!</button>

        <script type="text/javascript">

            context = new AudioContext;

            // Note frequencies - starting from C3
            noteFrequencies = [131, 139, 147, 156, 165, 175, 185, 196, 208, 220, 233, 247, 262, 277, 294, 311, 330, 349, 370, 392, 415, 440, 466, 494]; 
            // Note values
            noteValues = {
                'Semicroma 1/16': 0.25,
                'Croma 1/8': 0.5,
                'Semiminima 1/4': 1,
                'Minima 2/4': 2,
                'Semibreve 4/4': 4
            };
            // Scale steps  - 1: S, 2: T
            scales = {
                'ionian': [2,2,1,2,2,2,1],
                'dorian': [2,1,2,2,2,1,2],
                'phrygian': [1,2,2,2,1,2,2],
                'lydian': [2,2,2,1,2,2,1],
                'mixolydian': [2,2,1,2,2,1,2],  
                'aeolian': [2,1,2,2,1,2,2],  
                'locrian': [1,2,2,1,2,2,2]
            };

            function playScale() {
                // close current context (if any) and open a new one
                context.close();
                context = new AudioContext;

                var oscillator,
                    t = context.currentTime,
                    bpm = 120,
                    noteValue = 1,
                    noteLength = 1/(bpm/60) * noteValue,
                    index = parseInt(document.getElementById("tonality").value),
                    scale = [0].concat(scales[document.getElementById("scale").value]);

                for (var i = 0; i < scale.length; i++) {
                    oscillator = context.createOscillator(); 
                    index += scale[i];
                    oscillator.frequency.value = noteFrequencies[index];
                    oscillator.start(t);
                    t += noteLength;
                    oscillator.stop(t);
                    oscillator.connect(context.destination);
                }
            }

        </script>

    </body>

</html>